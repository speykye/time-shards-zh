import { Component, inject } from '@angular/core';
import { MarkdownViewer } from '../markdown-viewer/markdown-viewer';
import { Location } from '@angular/common';

@Component({
  selector: 'app-guide',
  imports: [MarkdownViewer],
  templateUrl: './guide.html',
  styleUrl: './guide.scss',
  standalone: true,
})
export class Guide {
  private location = inject(Location);
  html = `
# 📘 Time-Shards 使用指南：给画师与金主的“防扯皮”记事本

## 👋 它是做什么的？

想象一下，你和别人合作画画（或任何委托），聊天记录散落在微信、QQ、Discord 里。
*   “当时说好了是改 2 次还是 3 次？”
*   “定金到底是哪天转的？”
*   “这张图是最终版还是草稿？”

**Time-Shards 就是一个专门用来记录这些“关键时刻”的电子记事本。**
它的特点是：**一旦记下来并“封存”，就再也无法偷偷修改**。如果以后发生争执，这就是最有力的证据。

---

## 🚀 快速开始：三步走

### 第一步：建立项目 (Project)
就像建一个专门的文件夹。
1.  在左侧点击 **“新建项目”**。
2.  起个名字，比如 **“狼人设定图 - 张三”**。
3.  （可选）在“项目简介”里写一句重点，例如：“3 个姿势，商用授权，10 月 1 日交稿”。

### 第二步：记录碎片 (Shard)
这是核心功能。把每一次重要的沟通、转账、发图，都变成一条“记录”。
点击右上角的 **“➕ 新增记录”**，你会看到三种类型：

#### 1. 🚩 里程碑 (Milestone) —— 用于定节点
*   **什么时候用？** 约定了什么时候该干什么事。
*   **怎么填？**
    *   **标题**：例如“草图阶段”、“线稿确认”、“尾款支付”。
    *   **截止日期**：选日子。
    *   **状态**：计划中 / 进行中 / 已完成。
*   **例子**：创建一个里程碑叫“初稿交付”，截止日是下周五。

#### 2. 📝 备注 (Note) —— 用于记流水账
*   **什么时候用？** 日常聊天里的重要结论，或者随手记下的事。
*   **怎么填？**
    *   **归属方**：是谁说的？（画师 / 金主 / 双方）。
    *   **关联里程碑**：如果这事是关于“初稿”的，就选刚才建的那个里程碑（这样以后好找）。
    *   **内容**：例如“金主确认喜欢蓝色调，不喜欢红色”。
    *   **📎 重要技巧**：如果你发了参考图或草图，可以在下方点击 **“+ 添加文件”**。系统**不会上传你的图片**，只会计算图片的“指纹”（哈希值）存下来。这能证明“在这个时间点，我确实发了这张图，且之后没被 P 过”。

#### 3. 📨 信函/协议 (Letter) —— 用于正式确认（防扯皮神器！）
*   **什么时候用？** 开工前定规矩、中途改需求、最后确认验收。
*   **怎么用？** 它有一个**“结构化模板”**，帮你把容易吵架的点都列出来：
    *   **交付内容**：画什么？几张？
    *   **用途**：能不能商用？能不能做周边？
    *   **修改次数**：包几轮修改？超过怎么收费？
    *   **范围边界**：明确写出**“不包含什么”**（例如：不含背景、不含源文件）。
*   **操作**：填好后，点击 **“复制信函文本”**，直接发给对方确认。对方回复“OK”后，你在系统里把状态改为“已确认”。

### 第三步：封存证据 (Seal) —— 给记录盖上“钢印”
当你记录完一条非常重要的内容（比如最终的报价单、验收确认），并且确定不会再改了：
1.  找到那条记录。
2.  点击右下角的 **“🔒 封存”** 按钮。
3.  系统会生成一个唯一的“数字指纹”并上传到公共验证网络。
4.  **效果**：这条记录从此**永久锁定**。如果有人（甚至是你自己）试图修改它，验证就会失败。这就好比在纸质合同上盖了骑缝章。

---

## 💡 核心概念通俗解释

### ❓ 什么是“哈希 (Hash)”？为什么要存它？
*   **通俗解释**：哈希就是文件的**“数字指纹”**。
*   **例子**：你有一张名为 'sketch.jpg' 的图。系统算出它的指纹是 'a1b2c3...'。
    *   如果你只改了一个像素，指纹就会变成 'x9y8z7...'。
    *   **作用**：我们只存这个指纹，**不存图片本身**（保护隐私，节省空间）。以后如果有人说“你当初发的图不是这张”，你拿出原图一算，指纹对不上，就说明图被换过；指纹对上了，就证明是原件。

### ❓ 什么是“封存 (Seal)”？
*   **通俗解释**：就像把日记本的一页用**透明胶带封死**，并在胶带上签了名、写了日期，还拍了一张照片发到朋友圈公示。
*   **作用**：
    *   **防篡改**：封死后，谁也不能偷偷回去改之前的记录。
    *   **自证清白**：如果以后闹纠纷，你可以把这个“封存回执”发给第三方（如米画师客服、闲鱼小法庭），他们可以通过公开网络验证这条记录是不是真的、有没有被改过。

### ❓ 数据存在哪？安全吗？
*   **本地优先**：所有数据默认只存在**你自己的浏览器**里。我们看不到你的任何记录。
*   **备份**：请务必定期点击顶部的 **“📥 导出备份”**，把 JSON 文件下载到电脑或网盘。如果清空浏览器缓存，数据会丢失（除非你导出了备份）。
*   **隐私**：即使你点了“封存”，上传到网络的也只是一串乱码（哈希值），**没有任何人能看到你的画作、金额或聊天内容**。

---

## 🛡️ 推荐工作流 (最佳实践)

为了最大化避免纠纷，建议按这个流程操作：

1.  **接单时**：
    *   新建项目。
    *   创建一条 **“📨 信函”**，填好价格、工期、修改次数、商用范围。
    *   发送给金主确认。
    *   金主确认后，在系统里标记“已确认”，并点击 **“🔒 封存”**。
    *   *(此时，合同已锁死)*

2.  **过程中**：
    *   每次发送草图/线稿，都创建一个 **“📝 备注”**，附上文件（生成指纹）。
    *   如果金主提出新需求（加东西），不要口头答应！
    *   新建一条 **“📨 信函 (变更请求)”**，写明“增加一个尾巴，费用 +50 元，工期 +2 天”。
    *   确认后 **“🔒 封存”**。

3.  **完结时**：
    *   创建 **“🚩 里程碑：验收完成”**。
    *   创建 **“📨 信函：验收确认”**，写明“金主确认收到所有文件，无异议，交易结束”。
    *   双方确认后 **“🔒 封存”**。

---

## ⚠️ 常见问题 (FAQ)

**Q: 我换了电脑/浏览器，数据还在吗？**
A: 不在。因为数据存在旧浏览器的缓存里。你必须先在旧电脑上点 **“📥 导出备份”**，把文件发到新电脑，然后在新电脑上点 **“📂 导入数据”**。

**Q: “封存”需要花钱吗？**
A: 不需要。目前的验证服务是免费的。

**Q: 我不小心删了一条记录怎么办？**
A: 如果没封存，删了就真没了（除非你有之前的备份）。如果已经封存了，系统是禁止删除的（只能“撤销封存”，但这会留下“曾经过撤销”的记录，对方会知道）。**所以，封存前请三思。**

**Q: 金主不会用这个怎么办？**
A: 没关系！**你自己用就行**。你只需要把生成的“信函文本”复制发给金主，把“封存回执”截图发给金主。只要你自己保留了完整的、不可篡改的时间线，在纠纷中你就占据了主动权。

---

## 🌟 总结
**Time-Shards 不是为了防君子，而是为了防小人。**
哪怕 99% 的单子都很愉快，只要有 1% 遇到扯皮，这个工具就能帮你省下几个晚上的失眠时间。

**现在，去创建你的第一个项目吧！** 🎨
  `;
  back() {
    this.location.back();
  }
}
